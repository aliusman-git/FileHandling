import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class Sales {
    public static void main(String[] args) {
        String filePath = "C:\\Users\\Lab User\\Desktop\\sales.txt";
        Map<String, Integer> productTotals = new HashMap<>();
        int grandTotal = 0;

        try {
            File myFile = new File(filePath);
            Scanner fileToRead = new Scanner(myFile);
            if (fileToRead.hasNextLine()) {
                fileToRead.nextLine();
            }
            while (fileToRead.hasNextLine()) {
                String line = fileToRead.nextLine();
                String[] fields = line.split("\t");

                if (fields.length >= 6) {
                    try {
                        String product = fields[3].trim(); // Product name
                        int qty = Integer.parseInt(fields[4].trim());
                        int unitPrice = Integer.parseInt(fields[5].trim());
                        int amount = qty * unitPrice;
                        productTotals.put(product, productTotals.getOrDefault(product, 0) + amount);

                        grandTotal += amount;
                    } catch (NumberFormatException e) {
                        System.out.println("Skipping line (invalid number): " + line);
                    }
                } else {
                    System.out.println("Skipping malformed line: " + line);
                }
            }

            fileToRead.close();
            for (Map.Entry<String, Integer> entry : productTotals.entrySet()) {
                System.out.println(entry.getKey() + " : " + entry.getValue());
            }

            System.out.println("Grand Total: " + grandTotal);

        } catch (FileNotFoundException e) {
            System.out.println("File not found: " + filePath);
        }
    }
}
